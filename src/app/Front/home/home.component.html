<div class="container">
  <!-- Formulaire de création de post -->
  <div class="post-form">
    <form [formGroup]="postForm" (ngSubmit)="addPost()">
      <div class="form-group">
        <label for="content">Add Post :</label>
        <textarea formControlName="content" id="content" name="content" class="form-control" rows="4"></textarea>
        <div *ngIf="postForm.get('content')?.invalid && (postForm.get('content')?.dirty || postForm.get('content')?.touched)" class="text-danger">
          Le contenu du post est requis.
        </div>
      </div>
      <button type="submit" [disabled]="postForm.invalid" class="btn btn-primary">Poster</button>
    </form>
  </div>

  <!-- Liste des Posts -->
  <div *ngIf="posts?.length > 0" class="mt-5">
    <div class="row">
      <div class="col-md-6" *ngFor="let post of posts">
        <div *ngIf="post.postStatus === 'APPROVED'" class="card mb-3 post">
          <button class="btn btn-tag btn-sm w-20"   [routerLink]="['/modify', post.id]">Modify</button>
          <div class="card-body">
            <p class="card-text"><strong>{{ post.student.name }}</strong></p>
            <p class="card-text">{{ post.content }}</p>
            <p class="card-text text-muted">{{ post.datePost }}</p>

            <!-- Boutons de like et dislike avec icônes plus petites -->
            <div class="btn-group" role="group" aria-label="Actions">
              <button type="button" class="btn btn-secondary btn-sm" >
                <mat-icon class="small-icon">thumb_up</mat-icon> Like
              </button>
              <button type="button" class="btn btn-secondary btn-sm">
                <mat-icon class="small-icon">thumb_down</mat-icon> Dislike
              </button>
            </div>

            <!-- Bouton "Supprimer" à l'extrémité droite -->
            <button (click)="deletePost(post.id)" class="btn btn-danger ml-auto">Supprimer</button>

            <!-- Zone des commentaires -->
            <div class="comments mt-3">
              <h6 class="text-muted">Comments :</h6>
              <form [formGroup]="createCommentForm" (ngSubmit)="addComment(post.id)">
                <div class="form-group">
                  <textarea formControlName="comment" id="comment" name="comment" class="form-control" rows="2" placeholder="Ajouter un commentaire"></textarea>
                  <div *ngIf="createCommentForm.get('comment')?.invalid && (createCommentForm.get('comment')?.dirty || createCommentForm.get('comment')?.touched)" class="text-danger">
                    Le contenu du commentaire est requis.
                  </div>
                </div>
                <button type="submit" [disabled]="createCommentForm.invalid" class="btn btn-primary">Commenter</button>
              </form>
              <!-- Liste des commentaires -->
              <ul class="list-unstyled mt-3">
                <li *ngFor="let comment of post.comments" class="comment">
                  <p><strong>{{ comment.user }}</strong></p>
                  <p>{{ comment.content }}</p>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Aucun post trouvé -->
  <div *ngIf="posts?.length === 0" class="mt-5">
    <p class="text-center">Aucun post trouvé.</p>
  </div>
</div>
